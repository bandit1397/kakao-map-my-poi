<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GitHub Pages ì¹´ì¹´ì˜¤ë§µ ì˜ˆì œ</title>
<link rel="icon" href="data:,">
<style>
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:16px; }
h1 { font-size: 20px; margin-bottom: 10px; }
.toolbar { display: flex; flex-wrap: wrap; gap: 8px; margin: 8px 0 12px; }
button { padding:6px 10px; border:1px solid #dcdcdc; border-radius:8px; background:#fff; cursor:pointer; }
button:hover { background:#f6f6f6; }
#map { width:100%; height:500px; border:1px solid #dcdcdc; border-radius:12px; }
.panel { display:grid; gap:10px; margin-top:12px; }
.list { border:1px solid #dcdcdc; border-radius:12px; padding:8px; max-height:260px; overflow:auto; }
.row { display:flex; align-items:center; gap:6px; padding:6px; border-bottom:1px dashed #eee; }
.row:last-child { border-bottom:none; }
.row .meta { flex:1; min-width:0; }
.row .title { font-weight:600; font-size:13px; }
.row .sub { color:#666; font-size:12px; }
.pill { padding:2px 6px; background:#f2f2f2; border-radius:999px; font-size:11px; }
.danger { color:#b00020; }
.foot { font-size:12px; color:#666; margin-top:8px; }
</style>
</head>
<body>
<h1>GitHub Pages ì¹´ì¹´ì˜¤ë§µ ì˜ˆì œ</h1>

<div id="map"></div>

<div class="toolbar">
  <button id="btnSave">ğŸ“ ë‚´ ìœ„ì¹˜ ì €ì¥</button>
  <button id="btnCenter">ğŸ¯ í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™</button>
  <button id="btnCsv">â¬‡ï¸ CSV ë‹¤ìš´ë¡œë“œ</button>
  <button id="btnJson">â¬‡ï¸ JSON ë‹¤ìš´ë¡œë“œ</button>
  <span class="pill" id="countPill">ì´ 0ê°œ</span>
</div>

<div class="panel">
  <div class="list" id="list"></div>
  <div class="foot">ğŸ’¡ ë§ˆì»¤ í´ë¦­ â†’ ì´ë¦„ í¸ì§‘/ì‚­ì œ ê°€ëŠ¥</div>
</div>

<!-- âœ… ì¹´ì¹´ì˜¤ë§µ SDK ì •ì  ë¡œë“œ -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=a2b526f8744f752fb07593aad9404d67&autoload=false&libraries=services,drawing"></script>

<script>
kakao.maps.load(function() {
  const container = document.getElementById('map');
  const options = { center: new kakao.maps.LatLng(37.5665, 126.9780), level:5 };
  const map = new kakao.maps.Map(container, options);

  const markers = [];
  const polyline = new kakao.maps.Polyline({
    path: [],
    strokeWeight:3,
    strokeColor:'#FF0000',
    strokeOpacity:0.8,
    strokeStyle:'solid'
  });
  polyline.setMap(map);

  const listEl = document.getElementById('list');
  const countPill = document.getElementById('countPill');
  let points = JSON.parse(localStorage.getItem('savedPoints') || '[]');
  renderList();

  function renderList() {
    listEl.innerHTML = '';
    markers.forEach(m => m.setMap(null));
    markers.length = 0;
    const path = [];

    points.forEach((p, idx) => {
      const marker = new kakao.maps.Marker({ position:new kakao.maps.LatLng(p.lat,p.lng), map:map });
      markers.push(marker);
      path.push(new kakao.maps.LatLng(p.lat,p.lng));

      kakao.maps.event.addListener(marker,'click',function() {
        const newName = prompt('ì´ë¦„ ìˆ˜ì • ë˜ëŠ” ì‚­ì œ (ê³µë°± ì…ë ¥ ì‹œ ì‚­ì œ):', p.name);
        if(newName === null) return;
        if(newName.trim() === '') points.splice(idx,1);
        else points[idx].name = newName;
        savePoints(); renderList();
      });

      const row = document.createElement('div');
      row.className='row';
      row.innerHTML=`<div class="meta"><div class="title">${p.name}</div><div class="sub">${p.lat.toFixed(5)}, ${p.lng.toFixed(5)}</div></div>`;
      listEl.appendChild(row);
    });

    polyline.setPath(path);
    countPill.textContent=`ì´ ${points.length}ê°œ`;
    savePoints();
  }

  function savePoints() { localStorage.setItem('savedPoints', JSON.stringify(points)); }

  document.getElementById('btnSave').addEventListener('click',function(){
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(function(pos){
        const lat=pos.coords.latitude, lng=pos.coords.longitude;
        const name=prompt('ì´ ìœ„ì¹˜ ì´ë¦„ ì…ë ¥:', `ìœ„ì¹˜ ${points.length+1}`);
        if(!name) return;
        points.push({name,lat,lng}); savePoints(); renderList();
      });
    } else alert('ìœ„ì¹˜ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
  });

  document.getElementById('btnCenter').addEventListener('click',function(){
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(function(pos){
        const lat=pos.coords.latitude, lng=pos.coords.longitude;
        map.setCenter(new kakao.maps.LatLng(lat,lng));
      });
    }
  });

  document.getElementById('btnCsv').addEventListener('click',function(){
    const csv='ì´ë¦„,ìœ„ë„,ê²½ë„\n'+points.map(p=>`${p.name},${p.lat},${p.lng}`).join('\n');
    downloadFile('points.csv',csv);
  });

  document.getElementById('btnJson').addEventListener('click',function(){
    downloadFile('points.json',JSON.stringify(points,null,2));
  });

  function downloadFile(filename,content){
    const blob=new Blob([content],{type:'text/plain'});
    const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=filename; a.click();
  }
});
</script>
</body>
</html>
