<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>내 위치 확인 (테스트용)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f30dd6f94c36231cde8591b5aa702957"></script>
    <style>
        #map { width: 100%; height: 400px; }
        button { margin: 5px; padding: 10px; }
    </style>
</head>
<body>
    <h2>내 위치 확인 프로그램 (권한 꺼짐 시 테스트용 좌표)</h2>
    <div id="map"></div>
    <button onclick="showMyLocation()">내 위치 확인</button>
    <button onclick="saveLocation()">저장</button>

    <script>
        var map = new kakao.maps.Map(document.getElementById('map'), {
            center: new kakao.maps.LatLng(37.5665, 126.9780), // 초기 위치: 서울
            level: 5
        });

        var marker;

        function showMyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    // 정상적으로 위치 가져오기 성공
                    var lat = position.coords.latitude;
                    var lng = position.coords.longitude;
                    displayLocation(lat, lng);
                }, function(error) {
                    // 위치 권한 거부 또는 오류 시 테스트 좌표 사용
                    alert("위치 정보를 가져올 수 없어 테스트용 좌표를 사용합니다.");
                    displayLocation(37.5665, 126.9780); // 서울 시청 좌표
                });
            } else {
                // 브라우저가 지원하지 않을 때
                alert("이 브라우저에서는 위치 정보가 지원되지 않아 테스트용 좌표를 사용합니다.");
                displayLocation(37.5665, 126.9780); // 서울 시청 좌표
            }
        }

        function displayLocation(lat, lng) {
            var locPosition = new kakao.maps.LatLng(lat, lng);
            if (!marker) {
                marker = new kakao.maps.Marker({
                    map: map,
                    position: locPosition
                });
            } else {
                marker.setPosition(locPosition);
            }
            map.setCenter(locPosition);
            alert("현재 위치:\n위도: " + lat + "\n경도: " + lng);
        }

        function saveLocation() {
            if (!marker) {
                alert("먼저 '내 위치 확인'을 눌러주세요.");
                return;
            }
            var id = prompt("이 좌표의 ID를 입력하세요:");
            if (id) {
                var pos = marker.getPosition();
                console.log("저장된 위치:", {id: id, latitude: pos.getLat(), longitude: pos.getLng()});
                alert("저장 완료! 콘솔을 확인하세요.");
            }
        }
    </script>
</body>
</html>
